<?php

class HomeController extends BaseController {

	/*
	|--------------------------------------------------------------------------
	| Default Home Controller
	|--------------------------------------------------------------------------
	|
	| You may wish to use controllers instead of, or in addition to, Closure
	| based routes. That's great! Here is an example controller method to
	| get you started. To route to this controller, just add the route:
	|
	|	Route::get('/', 'HomeController@showWelcome');
	|
	*/

	public function showLogin()
	{
		// show the form
		return View::make('pages.Members');
	}

	public function doLogin()
	{
	    // process the form
	    $rules = array('password' => 'required|alphaNum|min:3');

	    //run the validation rules on the inputs from the form
	    $validator = Validator::make(Input::all(), $rules);

	    // if the validator fails, redirect back to the form
	    if ($validator->fails()) {
	        return Redirect::to('Members')->withErrors($validator);
	    } else {

	        // do the validation
	        if (Auth::attempt('password', Input::get('password'))) {
	            // validation successful
	            // redirect them to the secure section or whatever

	            echo 'Success!';
	        } else {
	            // validation not successful, send back to form
	            return Redirect::to('login');
	        }
	    }
	}

}
